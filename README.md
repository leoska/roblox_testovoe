# roblox_testovoe

## Задание
Задание можно взять [отсюда](https://docs.google.com/document/d/1txeDl2bwvZxMC5yLeEo3bjE-lsHOxJxxuLEdxAOf3e4/edit?usp=sharing)

## Фидбэк

Вот фидбэк, который мне дали по коду:
#### Замечания по первой части:
- Баланс пользователя можно только вычитать, задача состояла в другом
- Реализация проверки на отрицательный баланс посредством контрейта не лучшая идея, так как контрейт будет срабатывать при любом изменении строки, лишние действия на уровне БД

#### Замечания по второй части:
- Крон должен был быть распределённым между серверами, а не в рамках одного мастера + воркеры
- Не совсем понял, для чего какие-то костыли с временем, когда сервера по стандарту должны работать по UTC времени, если запуск происходит локально, то и БД должна быть поднята локально и зона установлена на UTC
- Таймаут на задачи достаточно странная штука, потому что при первом запуске мы не можем знать, сколько может проработать задача, если она проработает чуть больше заданного таймаута, то мы завершим её, хотя может просто бд стала работать чуть медленнее и какие-то операции в рамках задачи шли чуть медленнее
- В функции запуска задачи и обработки её завершения есть целый ряд запросов в БД, но они все выполняются с отсутствием атомарности, а значит если инстанс упадёт на любом этапе, мы получаем рассинхрон данных
- Совершенно непонятно, что даёт функция checkCurrectRunningTasks и не смог разглядеть никакой четкой логики в её использовании
- Не разглядел в системе отказоустойчивость, когда какой-то инстанс может выйти из строя, его задачу должен взять другой
- Не увидел балансировки нагрузки, примерно равномерного распределения задач между инстансами
  
